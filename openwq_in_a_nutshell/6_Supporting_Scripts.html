<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>OpenWQ - Supporting Scripts Guide</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=JetBrains+Mono:wght@400;500&display=swap');

        :root {
            --primary: #0066cc;
            --primary-dark: #004499;
            --secondary: #00a86b;
            --accent: #ff6b35;
            --purple: #7c3aed;
            --teal: #0891b2;
            --rose: #e11d48;
            --dark: #1a1a2e;
            --text: #2d3436;
            --text-light: #636e72;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; }
        html, body { height: 100%; font-family: 'Inter', sans-serif; background: #000; overflow: hidden; }
        .presentation { height: 100vh; width: 100vw; position: relative; }

        .slide {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: none; flex-direction: column; padding: 55px 75px;
            background: linear-gradient(135deg, #ffffff 0%, #f5f7fa 100%); overflow: hidden;
        }
        .slide.active { display: flex; }

        .slide.title-slide {
            background: linear-gradient(135deg, var(--dark) 0%, #16213e 50%, #0f3460 100%);
            justify-content: center; align-items: center; text-align: center; color: white;
        }
        .slide.title-slide h1 { font-size: 4rem; font-weight: 700; margin-bottom: 0.5rem; }
        .slide.title-slide h1 span { color: var(--teal); }
        .slide.title-slide .subtitle { font-size: 2rem; font-weight: 300; color: #a0aec0; margin-bottom: 1rem; }
        .slide.title-slide .tagline { font-size: 1.3rem; color: #718096; max-width: 900px; }

        /* University Logo */
        .university-logo {
            position: absolute;
            bottom: 30px;
            right: 40px;
            height: 60px;
            opacity: 0.9;
        }
        .slide.title-slide .university-logo { height: 70px; }

        .slide.section-slide {
            background: linear-gradient(135deg, var(--teal) 0%, #0e7490 100%);
            justify-content: center; align-items: center; color: white;
        }
        .slide.section-slide.blue { background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%); }
        .slide.section-slide.purple { background: linear-gradient(135deg, var(--purple) 0%, #5b21b6 100%); }
        .slide.section-slide.rose { background: linear-gradient(135deg, var(--rose) 0%, #be123c 100%); }
        .slide.section-slide.green { background: linear-gradient(135deg, var(--secondary) 0%, #059669 100%); }
        .slide.section-slide h2 { font-size: 3.5rem; font-weight: 600; }
        .slide.section-slide .section-number { font-size: 10rem; font-weight: 700; opacity: 0.15; position: absolute; top: 40px; right: 80px; }

        .slide-header { margin-bottom: 30px; }
        .slide-header h2 { font-size: 2.5rem; font-weight: 600; color: var(--dark); border-left: 6px solid var(--teal); padding-left: 22px; }
        .slide-content { flex: 1; display: flex; flex-direction: column; }

        .two-column { display: grid; grid-template-columns: 1fr 1fr; gap: 45px; height: 100%; }
        .three-column { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 25px; }
        .column { display: flex; flex-direction: column; }

        .card {
            background: white; border-radius: 14px; padding: 22px;
            box-shadow: 0 6px 25px rgba(0,0,0,0.07); margin-bottom: 15px;
        }
        .card.primary { border-left: 5px solid var(--primary); }
        .card.secondary { border-left: 5px solid var(--secondary); }
        .card.accent { border-left: 5px solid var(--accent); }
        .card.purple { border-left: 5px solid var(--purple); }
        .card.teal { border-left: 5px solid var(--teal); }
        .card.rose { border-left: 5px solid var(--rose); }
        .card h3 { font-size: 1.25rem; color: var(--dark); margin-bottom: 10px; }
        .card h4 { font-size: 1.1rem; color: var(--primary-dark); margin-bottom: 8px; }
        .card p, .card li { font-size: 1rem; color: var(--text); line-height: 1.45; }

        ul, ol { margin-left: 20px; }
        li { font-size: 1.2rem; color: var(--text); margin-bottom: 10px; line-height: 1.35; }
        li strong { color: var(--primary-dark); }

        pre {
            background: var(--dark); color: #e2e8f0; padding: 18px; border-radius: 10px;
            font-family: 'JetBrains Mono', monospace; font-size: 0.8rem; line-height: 1.35; overflow-x: auto;
        }
        pre .comment { color: #68d391; }
        pre .string { color: #fbd38d; }
        pre .keyword { color: #63b3ed; }

        table { width: 100%; border-collapse: collapse; font-size: 0.95rem; background: white; border-radius: 10px; overflow: hidden; }
        th { background: var(--dark); color: white; padding: 10px 14px; text-align: left; font-weight: 600; }
        td { padding: 9px 14px; border-bottom: 1px solid #e2e8f0; }
        tr:nth-child(even) { background: #f8fafc; }

        .highlight-box {
            background: linear-gradient(135deg, #ecfeff, #cffafe);
            border-left: 5px solid var(--teal); padding: 18px 22px; border-radius: 0 10px 10px 0; margin: 12px 0;
        }
        .highlight-box.info { background: linear-gradient(135deg, #eff6ff, #dbeafe); border-left-color: var(--primary); }
        .highlight-box.success { background: linear-gradient(135deg, #ecfdf5, #d1fae5); border-left-color: var(--secondary); }
        .highlight-box.warning { background: linear-gradient(135deg, #fff7ed, #ffedd5); border-left-color: var(--accent); }
        .highlight-box.rose { background: linear-gradient(135deg, #fff1f2, #ffe4e6); border-left-color: var(--rose); }

        .slide-footer {
            display: flex; justify-content: space-between; align-items: center;
            padding-top: 12px; border-top: 1px solid #e2e8f0; margin-top: auto;
        }
        .slide-footer .logo { font-weight: 700; font-size: 1.1rem; color: var(--dark); }
        .slide-footer .logo span { color: var(--teal); }
        .slide-footer .page-number {
            background: var(--dark); color: white; width: 36px; height: 36px;
            border-radius: 50%; display: flex; align-items: center; justify-content: center; font-weight: 600; font-size: 0.9rem;
        }

        .workflow-step {
            display: flex; align-items: center; gap: 20px;
            background: white; padding: 18px 25px; border-radius: 12px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.06); margin-bottom: 15px;
        }
        .workflow-step .number {
            width: 45px; height: 45px; border-radius: 50%;
            background: var(--teal); color: white;
            display: flex; align-items: center; justify-content: center;
            font-size: 1.3rem; font-weight: 700; flex-shrink: 0;
        }
        .workflow-step .content h4 { font-size: 1.15rem; color: var(--dark); margin-bottom: 5px; }
        .workflow-step .content p { font-size: 0.95rem; color: var(--text-light); }

        .folder-tree {
            font-family: 'JetBrains Mono', monospace;
            font-size: 0.9rem;
            line-height: 1.6;
            background: #f8fafc;
            padding: 15px 20px;
            border-radius: 10px;
            border-left: 4px solid var(--teal);
        }
        .folder-tree .folder { color: var(--primary); font-weight: 600; }
        .folder-tree .file { color: var(--text); }
        .folder-tree .comment { color: var(--text-light); font-size: 0.85rem; }

        .nav-hint {
            position: fixed; bottom: 20px; left: 50%; transform: translateX(-50%);
            background: rgba(0,0,0,0.8); color: white; padding: 10px 22px; border-radius: 25px;
            font-size: 0.85rem; z-index: 1000; opacity: 0; transition: opacity 0.3s;
        }
        .nav-hint.visible { opacity: 1; }

        .diagram { background: white; border: 2px solid #e2e8f0; border-radius: 14px; padding: 20px; text-align: center; }
        .diagram pre { background: transparent; color: var(--text); display: inline-block; text-align: left; font-size: 0.85rem; }

        .script-badge {
            display: inline-block; padding: 4px 10px; border-radius: 4px;
            font-size: 0.75rem; font-weight: 600; margin-right: 6px;
        }
        .script-badge.python { background: #3776ab20; color: #3776ab; }
        .script-badge.config { background: #f0932b20; color: #f0932b; }
        .script-badge.output { background: #00a86b20; color: #00a86b; }
    </style>
</head>
<body>
    <div class="presentation" id="presentation">

        <!-- Slide 1: Title -->
        <div class="slide title-slide active" data-slide="1">
            <h1>Supporting <span>Scripts</span></h1>
            <div class="subtitle">Configuration, Post-Processing & Visualization</div>
            <div class="tagline">
                Python tools for model setup, reading HDF5 outputs,<br>
                creating time series plots, and generating spatial maps
            </div>
            <img src="uevora_logo.png" alt="University of √âvora" class="university-logo">
        </div>

        <!-- Slide 2: Overview -->
        <div class="slide" data-slide="2">
            <div class="slide-header">
                <h2>Scripts Organization</h2>
            </div>
            <div class="slide-content">
                <div class="two-column">
                    <div class="column">
                        <div class="folder-tree">
                            <span class="folder">üìÅ supporting_scripts/</span><br>
                            ‚îú‚îÄ‚îÄ <span class="folder">üìÅ Model_Config/</span> <span class="comment"># Configuration generation</span><br>
                            ‚îÇ   ‚îú‚îÄ‚îÄ template_model_config.py<br>
                            ‚îÇ   ‚îî‚îÄ‚îÄ <span class="folder">üìÅ config_support_lib/</span><br>
                            ‚îÇ       ‚îú‚îÄ‚îÄ Gen_Master_file.py<br>
                            ‚îÇ       ‚îú‚îÄ‚îÄ Gen_Config_file.py<br>
                            ‚îÇ       ‚îú‚îÄ‚îÄ Gen_BGQmodule_file.py<br>
                            ‚îÇ       ‚îú‚îÄ‚îÄ Gen_SS_Driver.py<br>
                            ‚îÇ       ‚îî‚îÄ‚îÄ ...<br>
                            ‚îú‚îÄ‚îÄ <span class="folder">üìÅ Read_Outputs/</span> <span class="comment"># Post-processing</span><br>
                            ‚îÇ   ‚îú‚îÄ‚îÄ template_reading_plotting.py<br>
                            ‚îÇ   ‚îî‚îÄ‚îÄ <span class="folder">üìÅ hdf5_support_lib/</span><br>
                            ‚îÇ       ‚îú‚îÄ‚îÄ Read_h5_driver.py<br>
                            ‚îÇ       ‚îú‚îÄ‚îÄ Plot_h5_driver.py<br>
                            ‚îÇ       ‚îî‚îÄ‚îÄ Map_h5_driver.py<br>
                            ‚îî‚îÄ‚îÄ <span class="folder">üìÅ Calibration/</span> <span class="comment"># Optimization</span><br>
                                ‚îî‚îÄ‚îÄ calibration_driver.py
                        </div>
                    </div>
                    <div class="column">
                        <div class="card teal">
                            <h3>üîß Model_Config</h3>
                            <p>Generate all JSON configuration files from a single Python template</p>
                        </div>
                        <div class="card primary">
                            <h3>üìä Read_Outputs</h3>
                            <p>Read HDF5 results, create plots, and generate spatial maps/GIFs</p>
                        </div>
                        <div class="card rose">
                            <h3>üéØ Calibration</h3>
                            <p>Sensitivity analysis and parameter optimization (covered in separate presentation)</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="slide-footer">
                <div class="logo">Open<span>WQ</span></div>
                <div class="page-number">2</div>
            </div>
        </div>

        <!-- Slide 3: Section - Configuration -->
        <div class="slide section-slide" data-slide="3">
            <div class="section-number">01</div>
            <h2>Model Configuration</h2>
        </div>

        <!-- Slide 4: Configuration Template -->
        <div class="slide" data-slide="4">
            <div class="slide-header">
                <h2>Configuration Template (template_model_config.py)</h2>
            </div>
            <div class="slide-content">
                <p style="font-size: 1.1rem; margin-bottom: 20px;">
                    A single Python file controls ALL OpenWQ configuration ‚Äî no need to manually edit JSON files!
                </p>
                <div class="two-column" style="gap: 35px;">
                    <div class="column">
                        <pre style="font-size: 0.75rem;">
<span class="comment"># ========== GENERAL INFORMATION ==========</span>
project_name = <span class="string">"My Project"</span>
hostmodel = <span class="string">"mizuroute"</span>   <span class="comment"># or "summa"</span>
dir2save_input_files = <span class="string">"/path/to/output/"</span>
running_on_docker = <span class="keyword">True</span>

<span class="comment"># ========== COMPUTATIONAL SETTINGS ==========</span>
solver = <span class="string">"FORWARD_EULER"</span>
use_num_threads = <span class="keyword">4</span>

<span class="comment"># ========== INITIAL CONDITIONS ==========</span>
ic_all_value = <span class="keyword">2</span>
ic_all_units = <span class="string">"mg/l"</span>

<span class="comment"># ========== BIOGEOCHEMISTRY MODULE ==========</span>
bgc_module_name = <span class="string">"NATIVE_BGC_FLEX"</span>
path2selected_NATIVE_BGC_FLEX_framework = \
    <span class="string">"examples_BGC_frameworks/openWQ_Ncycling.json"</span>

<span class="comment"># ========== TRANSPORT MODULE ==========</span>
td_module_name = <span class="string">"OPENWQ_NATIVE_TD_ADVDISP"</span>
td_module_dispersion_xyz = [<span class="keyword">0.3</span>, <span class="keyword">0.3</span>, <span class="keyword">0.3</span>]
                        </pre>
                    </div>
                    <div class="column">
                        <div class="card teal">
                            <h3>Generated Files</h3>
                            <ul style="margin-left: 15px;">
                                <li style="font-size: 0.9rem;"><code>openwq_master.json</code></li>
                                <li style="font-size: 0.9rem;"><code>openwq_config.json</code></li>
                                <li style="font-size: 0.9rem;"><code>openwq_bgc_*.json</code></li>
                                <li style="font-size: 0.9rem;"><code>openwq_ss_*.json</code></li>
                                <li style="font-size: 0.9rem;"><code>openwq_ewf_*.json</code></li>
                                <li style="font-size: 0.9rem;"><code>openwq_output.json</code></li>
                            </ul>
                        </div>
                        <div class="highlight-box success">
                            <strong>Run once:</strong><br>
                            <code style="font-size: 0.9rem;">python template_model_config.py</code><br>
                            All JSON files are auto-generated!
                        </div>
                    </div>
                </div>
            </div>
            <div class="slide-footer">
                <div class="logo">Open<span>WQ</span></div>
                <div class="page-number">4</div>
            </div>
        </div>

        <!-- Slide 5: Configuration Sections -->
        <div class="slide" data-slide="5">
            <div class="slide-header">
                <h2>Configuration Sections</h2>
            </div>
            <div class="slide-content">
                <table style="font-size: 0.9rem;">
                    <tr>
                        <th>Section</th>
                        <th>Key Variables</th>
                        <th>Description</th>
                    </tr>
                    <tr>
                        <td><strong>1. General Info</strong></td>
                        <td>project_name, hostmodel, dir2save</td>
                        <td>Project metadata and output directory</td>
                    </tr>
                    <tr>
                        <td><strong>2. Computational</strong></td>
                        <td>solver, use_num_threads</td>
                        <td>Solver type and parallelization</td>
                    </tr>
                    <tr>
                        <td><strong>3. Initial Conditions</strong></td>
                        <td>ic_all_value, ic_all_units</td>
                        <td>Starting concentrations</td>
                    </tr>
                    <tr>
                        <td><strong>4a. BGC Module</strong></td>
                        <td>bgc_module_name, path2framework</td>
                        <td>NATIVE_BGC_FLEX or PHREEQC</td>
                    </tr>
                    <tr>
                        <td><strong>4b. Transport Module</strong></td>
                        <td>td_module_name, dispersion_xyz</td>
                        <td>Advection/dispersion settings</td>
                    </tr>
                    <tr>
                        <td><strong>4c. Lateral Exchange</strong></td>
                        <td>le_module_name, le_module_config</td>
                        <td>Inter-compartment exchange</td>
                    </tr>
                    <tr>
                        <td><strong>4d. Sediment Transport</strong></td>
                        <td>ts_module_name, ts_parameters</td>
                        <td>HYPE_MMF or HYPE_HBVSED</td>
                    </tr>
                    <tr>
                        <td><strong>4e. Sorption</strong></td>
                        <td>si_module_name, si_species_params</td>
                        <td>Freundlich or Langmuir isotherms</td>
                    </tr>
                    <tr>
                        <td><strong>5. Source/Sink</strong></td>
                        <td>ss_method, ss_method_csv_config</td>
                        <td>CSV, LULC, or ML-based loads</td>
                    </tr>
                    <tr>
                        <td><strong>6. External Fluxes</strong></td>
                        <td>ewf_method, ewf_method_*</td>
                        <td>Concentrations in external inputs</td>
                    </tr>
                    <tr>
                        <td><strong>7. Output</strong></td>
                        <td>output_format, chemical_species</td>
                        <td>What to save and where</td>
                    </tr>
                </table>
            </div>
            <div class="slide-footer">
                <div class="logo">Open<span>WQ</span></div>
                <div class="page-number">5</div>
            </div>
        </div>

        <!-- Slide 6: Source/Sink Methods -->
        <div class="slide" data-slide="6">
            <div class="slide-header">
                <h2>Source/Sink Configuration Methods</h2>
            </div>
            <div class="slide-content">
                <div class="three-column" style="gap: 20px;">
                    <div class="card teal">
                        <h3><span class="script-badge config">CSV</span> load_from_csv</h3>
                        <p style="margin-bottom: 10px;">Load time series from CSV files</p>
                        <pre style="font-size: 0.7rem; padding: 10px;">
ss_method_csv_config = [
  {
    <span class="string">"Chemical_name"</span>: <span class="string">"NO3-N"</span>,
    <span class="string">"Compartment"</span>: <span class="string">"REACHES"</span>,
    <span class="string">"Type"</span>: <span class="string">"source"</span>,
    <span class="string">"Units"</span>: <span class="string">"kg"</span>,
    <span class="string">"Filepath"</span>: <span class="string">"loads.csv"</span>
  }
]
                        </pre>
                    </div>
                    <div class="card primary">
                        <h3><span class="script-badge config">LULC</span> Copernicus</h3>
                        <p style="margin-bottom: 10px;">Land use + export coefficients</p>
                        <pre style="font-size: 0.7rem; padding: 10px;">
ss_method = <span class="string">"using_copernicus_
            lulc_with_static_coeff"</span>

<span class="comment"># Maps LULC classes to loads</span>
<span class="comment"># e.g., cropland ‚Üí 20 kg/ha/yr</span>
                        </pre>
                    </div>
                    <div class="card purple">
                        <h3><span class="script-badge python">ML</span> ml_model</h3>
                        <p style="margin-bottom: 10px;">Train ML from monitoring data</p>
                        <pre style="font-size: 0.7rem; padding: 10px;">
ss_method = <span class="string">"ml_model"</span>
ss_ml_model_type = <span class="string">"xgboost"</span>
ss_ml_training_data_csv = \
    <span class="string">"monitoring_data.csv"</span>
                        </pre>
                    </div>
                </div>
                <div class="highlight-box info" style="margin-top: 20px;">
                    <strong>Cell ID Mapping:</strong> Set <code>ss_use_cellid_mapping = True</code> to use host model IDs
                    (reachID for mizuroute, hruId_z{layer} for SUMMA) instead of internal (ix, iy, iz) indices.
                </div>
            </div>
            <div class="slide-footer">
                <div class="logo">Open<span>WQ</span></div>
                <div class="page-number">6</div>
            </div>
        </div>

        <!-- Slide 7: Section - Reading Results -->
        <div class="slide section-slide blue" data-slide="7">
            <div class="section-number">02</div>
            <h2>Reading Model Results</h2>
        </div>

        <!-- Slide 8: Read_h5_driver -->
        <div class="slide" data-slide="8">
            <div class="slide-header">
                <h2>Reading HDF5 Output (Read_h5_driver)</h2>
            </div>
            <div class="slide-content">
                <div class="two-column" style="gap: 35px;">
                    <div class="column">
                        <pre style="font-size: 0.75rem;">
<span class="keyword">import</span> sys
sys.path.insert(<span class="keyword">0</span>, <span class="string">'hdf5_support_lib'</span>)
<span class="keyword">import</span> Read_h5_driver <span class="keyword">as</span> h5_rlib

<span class="comment"># Define paths</span>
openwq_info = {
    <span class="string">"path_to_results"</span>: <span class="string">"/path/to/openwq_out"</span>,
    <span class="string">"mapping_key"</span>: <span class="string">"reachID"</span>
}

<span class="comment"># Read results</span>
results = h5_rlib.Read_h5_driver(
    openwq_info=openwq_info,
    output_format=<span class="string">'HDF5'</span>,
    cmp=[<span class="string">'RIVER_NETWORK_REACHES'</span>],
    space_elem=<span class="string">'all'</span>,
    chemSpec=[<span class="string">"NO3-N"</span>, <span class="string">"NH4-N"</span>],
    chemUnits=<span class="string">"MG/L"</span>,
    noDataFlag=<span class="keyword">-9999</span>,
    sediment_as_well=<span class="keyword">True</span>,   <span class="comment"># also read sediment</span>
    debugmode=<span class="keyword">False</span>
)
                        </pre>
                    </div>
                    <div class="column">
                        <div class="card primary">
                            <h3>Parameters</h3>
                            <table style="font-size: 0.85rem;">
                                <tr><td><strong>cmp</strong></td><td>Compartment(s) to read</td></tr>
                                <tr><td><strong>space_elem</strong></td><td>'all' or list of cell IDs</td></tr>
                                <tr><td><strong>chemSpec</strong></td><td>Species to extract</td></tr>
                                <tr><td><strong>chemUnits</strong></td><td>Units in output files</td></tr>
                                <tr><td><strong>sediment_as_well</strong></td><td>Also read sediment HDF5</td></tr>
                                <tr><td><strong>debugmode</strong></td><td>Read debug outputs</td></tr>
                            </table>
                        </div>
                        <div class="highlight-box success">
                            <strong>Returns:</strong> Dictionary with datetime index, concentrations per species/cell, and optional sediment data
                        </div>
                    </div>
                </div>
            </div>
            <div class="slide-footer">
                <div class="logo">Open<span>WQ</span></div>
                <div class="page-number">8</div>
            </div>
        </div>

        <!-- Slide 9: Section - Plotting -->
        <div class="slide section-slide purple" data-slide="9">
            <div class="section-number">03</div>
            <h2>Plotting Time Series</h2>
        </div>

        <!-- Slide 10: Plot_h5_driver -->
        <div class="slide" data-slide="10">
            <div class="slide-header">
                <h2>Time Series Plots (Plot_h5_driver)</h2>
            </div>
            <div class="slide-content">
                <div class="two-column" style="gap: 35px;">
                    <div class="column">
                        <pre style="font-size: 0.75rem;">
<span class="keyword">import</span> Plot_h5_driver <span class="keyword">as</span> h5_plib

h5_plib.Plot_h5_driver(
    <span class="comment"># What to plot?</span>
    what2map=<span class="string">'openwq'</span>,        <span class="comment"># or 'hostmodel'</span>
    hostmodel=<span class="string">'mizuroute'</span>,

    <span class="comment"># Which locations?</span>
    mapping_key_values=[<span class="keyword">1200014181</span>, <span class="keyword">200014181</span>],

    <span class="comment"># OpenWQ data (pre-loaded)</span>
    openwq_results=results,
    chemSpec=[<span class="string">"NO3-N"</span>, <span class="string">"N_ORG_active"</span>],
    sediment_as_well=<span class="keyword">True</span>,

    <span class="comment"># Host model comparison (optional)</span>
    hydromodel_info=hydromodel_info,
    hydromodel_var2print=<span class="string">'DWroutedRunoff'</span>,

    <span class="comment"># Output</span>
    output_path=<span class="string">'/path/to/plotSeries.png'</span>
)
                        </pre>
                    </div>
                    <div class="column">
                        <div class="card purple">
                            <h3>Plot Features</h3>
                            <ul style="margin-left: 15px;">
                                <li style="font-size: 0.9rem;">Multi-panel plots per species</li>
                                <li style="font-size: 0.9rem;">Multiple locations overlay</li>
                                <li style="font-size: 0.9rem;">Sediment concentration subplot</li>
                                <li style="font-size: 0.9rem;">Host model variable comparison</li>
                                <li style="font-size: 0.9rem;">Auto-scaled axes</li>
                            </ul>
                        </div>
                        <div class="diagram" style="padding: 15px;">
                            <pre style="font-size: 0.75rem;">
‚îå‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îê
‚îÇ  NO3-N Concentration              ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ             ‚îÇ
‚îÇ     ‚ï±‚ï≤    ‚ï±‚ï≤                      ‚îÇ
‚îÇ ‚îÄ‚îÄ‚îÄ‚ï±‚îÄ‚îÄ‚ï≤‚îÄ‚îÄ‚ï±‚îÄ‚îÄ‚ï≤‚îÄ‚îÄ‚îÄ  location 1      ‚îÇ
‚îÇ   ‚ï±    ‚ï≤‚ï±    ‚ï≤    location 2      ‚îÇ
‚îú‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚î§
‚îÇ  N_ORG_active                     ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ                    ‚îÇ
‚îÇ      ‚ï±‚ï≤                           ‚îÇ
‚îÇ  ‚îÄ‚îÄ‚îÄ‚ï±  ‚ï≤‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ                   ‚îÇ
‚îî‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
                            </pre>
                        </div>
                    </div>
                </div>
            </div>
            <div class="slide-footer">
                <div class="logo">Open<span>WQ</span></div>
                <div class="page-number">10</div>
            </div>
        </div>

        <!-- Slide 11: Section - Mapping -->
        <div class="slide section-slide green" data-slide="11">
            <div class="section-number">04</div>
            <h2>Spatial Mapping & GIFs</h2>
        </div>

        <!-- Slide 12: Map_h5_driver -->
        <div class="slide" data-slide="12">
            <div class="slide-header">
                <h2>Spatial Maps (Map_h5_driver)</h2>
            </div>
            <div class="slide-content">
                <div class="two-column" style="gap: 35px;">
                    <div class="column">
                        <pre style="font-size: 0.72rem;">
<span class="keyword">import</span> Map_h5_driver <span class="keyword">as</span> h5_mplib

<span class="comment"># 1) Shapefile for visualization</span>
shpfile_info = {
    <span class="string">'path_to_shp'</span>: <span class="string">'/path/to/segments.shp'</span>,
    <span class="string">'mapping_key'</span>: <span class="string">'SegId'</span>
}

<span class="comment"># 2) Generate maps</span>
h5_mplib.Map_h5_driver(
    what2map=<span class="string">'openwq'</span>,
    hostmodel=<span class="string">'mizuroute'</span>,

    <span class="comment"># Shapefile</span>
    shpfile_info=shpfile_info,

    <span class="comment"># Results data</span>
    openwq_results=results,
    chemSpec=[<span class="string">"NO3-N"</span>, <span class="string">"N_ORG_fresh"</span>],
    sediment_as_well=<span class="keyword">True</span>,

    <span class="comment"># Output settings</span>
    output_html_path=<span class="string">"/path/to/maps/"</span>,
    create_gif=<span class="keyword">True</span>,
    timeframes=<span class="keyword">30</span>,
    gif_duration=<span class="keyword">30</span>
)
                        </pre>
                    </div>
                    <div class="column">
                        <div class="card secondary">
                            <h3>Output Options</h3>
                            <table style="font-size: 0.85rem;">
                                <tr><td><strong>output_html_path</strong></td><td>Directory for output files</td></tr>
                                <tr><td><strong>create_gif</strong></td><td>Generate animated GIF</td></tr>
                                <tr><td><strong>timeframes</strong></td><td>Number of frames to include</td></tr>
                                <tr><td><strong>gif_duration</strong></td><td>GIF duration in seconds</td></tr>
                            </table>
                        </div>
                        <div class="highlight-box">
                            <strong>Requirements:</strong><br>
                            ‚Ä¢ Shapefile with matching IDs<br>
                            ‚Ä¢ <code>geopandas</code>, <code>matplotlib</code><br>
                            ‚Ä¢ <code>imageio</code> (for GIF creation)
                        </div>
                        <div class="card accent" style="margin-top: 15px;">
                            <h3>Host Model Mapping</h3>
                            <p>Set <code>what2map='hostmodel'</code> to map discharge, runoff, or other hydro variables</p>
                        </div>
                    </div>
                </div>
            </div>
            <div class="slide-footer">
                <div class="logo">Open<span>WQ</span></div>
                <div class="page-number">12</div>
            </div>
        </div>

        <!-- Slide 13: Complete Workflow -->
        <div class="slide" data-slide="13">
            <div class="slide-header">
                <h2>Complete Post-Processing Workflow</h2>
            </div>
            <div class="slide-content">
                <div class="workflow-step">
                    <div class="number">1</div>
                    <div class="content">
                        <h4>Set Up Paths</h4>
                        <p>Define openwq_info, shpfile_info, and hydromodel_info dictionaries</p>
                    </div>
                </div>
                <div class="workflow-step">
                    <div class="number" style="background: var(--primary);">2</div>
                    <div class="content">
                        <h4>Read HDF5 Results</h4>
                        <p>Use Read_h5_driver to load concentration data for selected species and compartments</p>
                    </div>
                </div>
                <div class="workflow-step">
                    <div class="number" style="background: var(--purple);">3</div>
                    <div class="content">
                        <h4>Create Time Series Plots</h4>
                        <p>Use Plot_h5_driver to generate temporal evolution graphs at specific locations</p>
                    </div>
                </div>
                <div class="workflow-step">
                    <div class="number" style="background: var(--secondary);">4</div>
                    <div class="content">
                        <h4>Generate Spatial Maps</h4>
                        <p>Use Map_h5_driver to create static maps or animated GIFs of spatial distribution</p>
                    </div>
                </div>
                <div class="highlight-box info" style="margin-top: 15px;">
                    <strong>Template available:</strong> <code>supporting_scripts/Read_Outputs/template_reading_plotting_results.py</code>
                </div>
            </div>
            <div class="slide-footer">
                <div class="logo">Open<span>WQ</span></div>
                <div class="page-number">13</div>
            </div>
        </div>

        <!-- Slide 14: Debug Mode -->
        <div class="slide" data-slide="14">
            <div class="slide-header">
                <h2>Debug Mode Outputs</h2>
            </div>
            <div class="slide-content">
                <p style="font-size: 1.1rem; margin-bottom: 20px;">
                    When <code>run_mode_debug = True</code> in configuration, additional diagnostic files are generated:
                </p>
                <div class="two-column" style="gap: 35px;">
                    <div class="column">
                        <div class="card rose">
                            <h3>Debug HDF5 Files</h3>
                            <table style="font-size: 0.85rem;">
                                <tr><td><strong>d_output_dt_chemistry</strong></td><td>Chemical reaction rates</td></tr>
                                <tr><td><strong>d_output_dt_transport</strong></td><td>Advection/dispersion fluxes</td></tr>
                                <tr><td><strong>d_output_ss</strong></td><td>Source/sink contributions</td></tr>
                                <tr><td><strong>d_output_ewf</strong></td><td>External water flux inputs</td></tr>
                                <tr><td><strong>d_output_ic</strong></td><td>Initial condition values</td></tr>
                            </table>
                        </div>
                    </div>
                    <div class="column">
                        <div class="card primary">
                            <h3>Reading Debug Data</h3>
                            <pre style="font-size: 0.75rem; padding: 12px;">
results = h5_rlib.Read_h5_driver(
    ...
    debugmode=<span class="keyword">True</span>  <span class="comment"># Enable debug reading</span>
)

<span class="comment"># Access debug data</span>
chemistry_rates = results[<span class="string">'d_chemistry'</span>]
transport_flux = results[<span class="string">'d_transport'</span>]
                            </pre>
                        </div>
                        <div class="highlight-box warning">
                            <strong>Note:</strong> Debug mode significantly increases output file size and simulation time
                        </div>
                    </div>
                </div>
            </div>
            <div class="slide-footer">
                <div class="logo">Open<span>WQ</span></div>
                <div class="page-number">14</div>
            </div>
        </div>

        <!-- Slide 15: Dependencies -->
        <div class="slide" data-slide="15">
            <div class="slide-header">
                <h2>Python Dependencies</h2>
            </div>
            <div class="slide-content">
                <div class="two-column" style="gap: 40px;">
                    <div class="column">
                        <div class="card teal">
                            <h3>Core Requirements</h3>
                            <pre style="font-size: 0.85rem; padding: 12px;">
<span class="comment"># Install with pip</span>
pip install numpy pandas h5py
pip install matplotlib
pip install geopandas shapely
pip install imageio   <span class="comment"># for GIF creation</span>
                            </pre>
                        </div>
                        <div class="card primary">
                            <h3>Optional (ML/Calibration)</h3>
                            <pre style="font-size: 0.85rem; padding: 12px;">
pip install scikit-learn
pip install xgboost
pip install SALib    <span class="comment"># sensitivity analysis</span>
                            </pre>
                        </div>
                    </div>
                    <div class="column">
                        <div class="card secondary">
                            <h3>Version Recommendations</h3>
                            <table style="font-size: 0.9rem;">
                                <tr><td>Python</td><td>‚â• 3.8</td></tr>
                                <tr><td>numpy</td><td>‚â• 1.20</td></tr>
                                <tr><td>pandas</td><td>‚â• 1.3</td></tr>
                                <tr><td>h5py</td><td>‚â• 3.0</td></tr>
                                <tr><td>geopandas</td><td>‚â• 0.10</td></tr>
                                <tr><td>matplotlib</td><td>‚â• 3.4</td></tr>
                            </table>
                        </div>
                        <div class="highlight-box success" style="margin-top: 15px;">
                            <strong>Conda environment:</strong><br>
                            <code style="font-size: 0.85rem;">conda env create -f environment.yml</code>
                        </div>
                    </div>
                </div>
            </div>
            <div class="slide-footer">
                <div class="logo">Open<span>WQ</span></div>
                <div class="page-number">15</div>
            </div>
        </div>

        <!-- Slide 16: Tips & Best Practices -->
        <div class="slide" data-slide="16">
            <div class="slide-header">
                <h2>Tips & Best Practices</h2>
            </div>
            <div class="slide-content">
                <div class="two-column" style="gap: 40px;">
                    <div class="column">
                        <div class="card secondary">
                            <h3>‚úÖ Do</h3>
                            <ul style="margin-left: 15px;">
                                <li style="font-size: 0.95rem;">Use template files as starting point</li>
                                <li style="font-size: 0.95rem;">Enable cell_id mapping for portability</li>
                                <li style="font-size: 0.95rem;">Start with <code>debugmode=False</code></li>
                                <li style="font-size: 0.95rem;">Test with small time windows first</li>
                                <li style="font-size: 0.95rem;">Verify shapefile ID matches output</li>
                                <li style="font-size: 0.95rem;">Use relative paths in Docker mode</li>
                            </ul>
                        </div>
                    </div>
                    <div class="column">
                        <div class="card rose">
                            <h3>‚ùå Don't</h3>
                            <ul style="margin-left: 15px;">
                                <li style="font-size: 0.95rem;">Edit generated JSON files directly</li>
                                <li style="font-size: 0.95rem;">Mix host model IDs with (ix,iy,iz)</li>
                                <li style="font-size: 0.95rem;">Run debug mode for production</li>
                                <li style="font-size: 0.95rem;">Load all cells if only need subset</li>
                                <li style="font-size: 0.95rem;">Create GIFs with 1000+ frames</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="highlight-box" style="margin-top: 20px;">
                    <strong>Quick Start:</strong> Copy <code>template_reading_plotting_results.py</code>,
                    update paths, and run ‚Äî all plots and maps generated automatically!
                </div>
            </div>
            <div class="slide-footer">
                <div class="logo">Open<span>WQ</span></div>
                <div class="page-number">16</div>
            </div>
        </div>

        <!-- Slide 17: Summary -->
        <div class="slide" data-slide="17">
            <div class="slide-header">
                <h2>Summary</h2>
            </div>
            <div class="slide-content">
                <div class="three-column">
                    <div class="card teal" style="text-align: center;">
                        <h3 style="justify-content: center;">üîß Configure</h3>
                        <p><code>template_model_config.py</code><br>‚Üí All JSON files auto-generated</p>
                    </div>
                    <div class="card primary" style="text-align: center;">
                        <h3 style="justify-content: center;">üìä Read & Plot</h3>
                        <p><code>Read_h5_driver</code> + <code>Plot_h5_driver</code><br>‚Üí Time series at any location</p>
                    </div>
                    <div class="card secondary" style="text-align: center;">
                        <h3 style="justify-content: center;">üó∫Ô∏è Map</h3>
                        <p><code>Map_h5_driver</code><br>‚Üí Spatial maps & animated GIFs</p>
                    </div>
                </div>
                <div class="highlight-box success" style="margin-top: 25px; text-align: center; font-size: 1.1rem;">
                    <strong>All scripts in:</strong> <code>supporting_scripts/</code> directory<br>
                    Use templates as starting points ‚Äî minimal coding required!
                </div>
            </div>
            <div class="slide-footer">
                <div class="logo">Open<span>WQ</span></div>
                <div class="page-number">17</div>
            </div>
        </div>

        <!-- Slide 18: Thank You -->
        <div class="slide title-slide" data-slide="18">
            <h1 style="font-size: 3.5rem;">Thank You</h1>
            <div class="subtitle" style="font-size: 1.8rem;">Questions & Resources</div>
            <div style="margin-top: 3rem;">
                <p style="font-size: 1.4rem; color: #a0aec0; margin-bottom: 15px;">
                    <strong>GitHub:</strong> github.com/ue-hydro/openwq
                </p>
                <p style="font-size: 1.4rem; color: #a0aec0; margin-bottom: 15px;">
                    <strong>Documentation:</strong> openwq.readthedocs.io
                </p>
                <p style="font-size: 1.4rem; color: #a0aec0;">
                    <strong>Scripts:</strong> supporting_scripts/
                </p>
            </div>
        </div>

    </div>

    <div class="nav-hint" id="navHint">Use ‚Üê ‚Üí arrows | Press F for fullscreen</div>

    <script>
        let currentSlide = 1;
        const totalSlides = document.querySelectorAll('.slide').length;

        function showSlide(n) {
            const slides = document.querySelectorAll('.slide');
            if (n > totalSlides) currentSlide = 1;
            if (n < 1) currentSlide = totalSlides;
            slides.forEach(slide => slide.classList.remove('active'));
            slides[currentSlide - 1].classList.add('active');
            history.replaceState(null, null, `#${currentSlide}`);
        }

        function nextSlide() { currentSlide++; showSlide(currentSlide); }
        function prevSlide() { currentSlide--; showSlide(currentSlide); }

        document.addEventListener('keydown', (e) => {
            switch(e.key) {
                case 'ArrowRight': case 'ArrowDown': case ' ': case 'PageDown': nextSlide(); break;
                case 'ArrowLeft': case 'ArrowUp': case 'PageUp': prevSlide(); break;
                case 'Home': currentSlide = 1; showSlide(currentSlide); break;
                case 'End': currentSlide = totalSlides; showSlide(currentSlide); break;
                case 'f': case 'F':
                    if (!document.fullscreenElement) document.documentElement.requestFullscreen();
                    else document.exitFullscreen();
                    break;
            }
        });

        document.querySelector('.presentation').addEventListener('click', (e) => {
            const rect = e.target.getBoundingClientRect();
            if (e.clientX - rect.left > rect.width / 2) nextSlide(); else prevSlide();
        });

        const navHint = document.getElementById('navHint');
        navHint.classList.add('visible');
        setTimeout(() => navHint.classList.remove('visible'), 4000);

        let hintTimeout;
        document.addEventListener('mousemove', () => {
            navHint.classList.add('visible');
            clearTimeout(hintTimeout);
            hintTimeout = setTimeout(() => navHint.classList.remove('visible'), 2000);
        });

        if (window.location.hash) {
            const slideNum = parseInt(window.location.hash.substring(1));
            if (slideNum >= 1 && slideNum <= totalSlides) currentSlide = slideNum;
        }
        showSlide(currentSlide);

        let touchStartX = 0;
        document.addEventListener('touchstart', (e) => { touchStartX = e.changedTouches[0].screenX; });
        document.addEventListener('touchend', (e) => {
            const diff = touchStartX - e.changedTouches[0].screenX;
            if (Math.abs(diff) > 50) { if (diff > 0) nextSlide(); else prevSlide(); }
        });
    </script>
</body>
</html>
